# 📊 UML-диаграммы проекта MedBook Platform

                   ┌────────────────────────────────────┐
                   │        MedBook Platform            │
                   ├────────────────────────────────────┤
                   │                                    │
                   │  ┌─────────────┐  ┌─────────────┐  │
                   │  │ Поиск врачей│  │ Запись на   │  │
                   │  │             │  │  приём      │  │
                   │  └──────┬──────┘  └──────┬──────┘  │
                   │         │                │         │
                   │  ┌──────▼──────┐  ┌──────▼──────┐  │
                   │  │Управление   │  │Управление   │  │
                   │  │ записями    │  │расписанием  │  │
                   │  └──────┬──────┘  └──────┬──────┘  │
                   │         │                │         │
                   │  ┌──────▼──────┐  ┌──────▼──────┐  │
                   │  │Получение    │  │Просмотр     │  │
                   │  │уведомлений  │  │ записей     │  │
                   │  └──────┬──────┘  └──────┬──────┘  │
                   │         │                │         │
                   │  ┌──────▼──────┐  ┌──────▼──────┐  │
                   │  │Ведение      │  │Управление   │  │
                   │  │карточек     │  │пользователями│ │
                   │  └──────┬──────┘  └──────┬──────┘  │
                   │         │                │         │
                   │  ┌──────▼──────┐  ┌──────▼──────┐  │
                   │  │Мониторинг   │  │Управление   │  │
                   │  │ системы     │  │ парсером    │  │
                   │  └─────────────┘  └─────────────┘  │
                   │                                    │
                   └────────────────────────────────────┘
         ▲               ▲               ▲              ▲
         │               │               │              │
         │               │               │              │
    ┌────┴────┐    ┌────┴────┐    ┌───── ┴─────┐   ┌────┴────┐
    │ Пациент │    │  Врач   │    │Администратор│ │ Система  │
    └─────────┘    └─────────┘    └───────────┘   └───────── ┘


2. Диаграмма классов (Class Diagram)

┌─────────────────────────────────────────────────────────────┐
│                       User                                  │
├─────────────────────────────────────────────────────────────┤
│ - id: UUID                                                 │
│ - email: String                                            │
│ - password_hash: String                                    │
│ - role: UserRole (PATIENT, DOCTOR, ADMIN)                  │
│ - created_at: DateTime                                     │
│ - updated_at: DateTime                                     │
├─────────────────────────────────────────────────────────────┤
│ + authenticate(password: String): Boolean                  │
│ + get_full_name(): String                                  │
│ + change_password(old_pass, new_pass): Boolean             │
└───────────────┬─────────────────────────────────────────────┘
                │
        ┌───────┴─────────┐
        │                 │
┌───────▼─────┐   ┌──────▼──────┐   ┌───────▼──────┐
│   Patient   │   │    Doctor   │   │   Admin      │
├─────────────┤   ├─────────────┤   ├──────────────┤
│ - dob: Date │   │ - spec: String│  │ - permissions│
│ - phone: String│ │ - license: String││           │
│ - address: String││ - experience: int││          │
└───────┬─────┘   └──────┬──────┘   └──────────────┘
        │                 │
        │           ┌─────┴─────┐
        │           │  Schedule │
        │           ├───────────┤
        │           │ - hours: JSON│
        │           │ - breaks: JSON│
        │           └─────┬─────┘
        │                 │
┌───────▼─────────────────▼─────┐
│        Appointment            │
├───────────────────────────────┤
│ - id: UUID                   │
│ - patient_id: UUID           │
│ - doctor_id: UUID            │
│ - datetime: DateTime         │
│ - status: Status             │
│ - notes: Text                │
├───────────────────────────────┤
│ + cancel(): Boolean          │
│ + reschedule(new_time): Boolean│
└──────────────┬────────────────┘
               │
       ┌───────▼───────┐
       │ MedicalRecord │
       ├───────────────┤
       │ - diagnosis   │
       │ - prescription│
       │ - attachments │
       └───────────────┘


3. Диаграмма последовательности (Sequence Diagram) - Запись на приём


Пациент           Frontend            Backend API        База данных    Telegram Bot
   │                   │                    │                  │               │
   │──1. Поиск врача──▶│                    │                  │               │
   │                   │──2. GET /doctors──▶│                  │               │
   │                   │                    │──3. Query DB────▶│               │
   │                   │                    │                  │──4. Results──▶│
   │                   │                    │◀─5. Results──────│               │
   │                   │◀─6. Doctor list────│                  │               │
   │◀─7. Show results──│                    │                  │               │
   │                   │                    │                  │               │
   │──8. Выбор врача──▶│                    │                  │               │
   │                   │──9. GET /schedule─▶│                  │               │
   │                   │                    │─10. Check slots─▶│               │
   │                   │                    │                  │─11. Slots────▶│
   │                   │                    │◀─12. Slots───────│               │
   │                   │◀─13. Available─────│                  │               │
   │◀─14. Show slots───│                    │                  │               │
   │                   │                    │                  │               │
   │──15. Book slot───▶│                    │                  │               │
   │                   │──16. POST /appoint▶│                  │               │
   │                   │                    │─17. Create appt─▶│               │
   │                   │                    │                  │─18. Success──▶│
   │                   │                    │◀─19. Success─────│               │
   │                   │                    │──20. Notify bot─▶│               │
   │                   │                    │                  │               │──21. Send──▶
   │                   │◀─22. Confirmation──│                  │               │
   │◀─23. Success──────│                    │                  │               │
   │                   │                    │                  │               │


   4. Диаграмма состояний (State Diagram) - Жизненный цикл записи


       ┌─────────────────────────────────────────────────┐
    │            Жизненный цикл записи                │
    └─────────────────────────────────────────────────┘
    
            ┌───────────┐
            │  [*]      │
            └─────┬─────┘
                  │
           ┌──────▼──────┐
           │   Created   │◀─────────────────┐
           │  (Создана)  │                  │
           └──────┬──────┘                  │
                  │                         │
           ┌──────▼──────┐           ┌─────┴──────┐
           │  Pending    │           │ Rescheduled│
           │(Ожидает     │           │ (Перенесена)│
           │ подтверждения)          └─────┬──────┘
           └──────┬──────┘                  │
            │     │                         │
    ┌───────▼─────▼────────┐        ┌──────▼──────┐
    ▼                      ▼        │ Confirmed   │
┌─────────┐          ┌─────────┐    │(Подтверждена)│
│Cancelled│          │Confirmed│    └──────┬──────┘
│(Отменена)│          │(Подтверждена)       │
└─────────┘          └────┬────┘           │
                           │                │
                    ┌──────▼──────┐  ┌─────▼──────┐
                    │   Active    │  │ Cancelled  │
                    │  (Активна)  │  │ (Отменена) │
                    └──────┬──────┘  └────────────┘
                           │
                    ┌──────▼──────┐
                    │  Completed  │
                    │ (Завершена) │
                    └──────┬──────┘
                           │
                    ┌──────▼──────┐
                    │    [*]      │
                    └─────────────┘


5. Диаграмма компонентов (Component Diagram)

┌─────────────────────────────────────────────────────────────────┐
│                  MedBook Platform Architecture                   │
└─────────────────────────────────────────────────────────────────┘

┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐
│   Frontend      │      │   API Gateway   │      │   Backend       │
│   (React)       │──────▶   (NGINX)       │──────▶   Services      │
│                 │ HTTP │                 │ REST │                 │
│ - Patient Portal│      │ - Load Balancing│      │ - Auth Service  │
│ - Doctor Portal │      │ - Rate Limiting │      │ - User Service  │
│ - Admin Panel   │      │ - SSL/TLS       │      │ - Doctor Service│
└─────────────────┘      └────────┬────────┘      │ - Appt Service  │
                                   │               │ - Notif Service │
                            ┌──────▼──────┐       │ - Parser Service│
                            │   Database  │       └────────┬────────┘
                            │   Layer     │                │
                            │             │        ┌───────▼───────┐
                            │ - PostgreSQL│        │   Cache & MQ  │
                            │ - Redis     │◀───────▶               │
                            │ - RabbitMQ  │        │ - Redis Cache │
                            └─────────────┘        │ - Message Q   │
                                                   └───────┬───────┘
                                                           │
                                                   ┌───────▼───────┐
                                                   │   External    │
                                                   │   Services    │
                                                   │               │
                                                   │ - Telegram API│
                                                   │ - Email SMTP  │
                                                   │ - Web Sources │
                                                   └───────────────┘



6. Диаграмма развёртывания (Deployment Diagram)

        ┌─────────────────────────────────────────────────────────┐
        │                    Cloud Infrastructure                  │
        └─────────────────────────────────────────────────────────┘
        
        ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
        │   Load Balancer │    │   Web Servers   │    │  App Servers    │
        │                 │    │                 │    │                 │
        │ - HAProxy       │────▶ - Nginx         │────▶ - FastAPI      │
        │ - SSL Term.     │    │ - Static Files  │    │ - Python 3.9+  │
        └─────────────────┘    └────────┬────────┘    └────────┬────────┘
                                         │                      │
                                ┌────────▼────────┐    ┌────────▼────────┐
                                │   Database      │    │   Cache & Queue │
                                │   Cluster       │    │                 │
                                │                 │    │ - Redis         │
                                │ - PostgreSQL    │◀───▶ - RabbitMQ      │
                                │ - Primary/Replica│   │ - Celery        │
                                └─────────────────┘    └─────────────────┘
                                         │                      │
                                ┌────────▼────────┐    ┌────────▼────────┐
                                │   Storage       │    │   Monitoring    │
                                │                 │    │                 │
                                │ - S3/MinIO      │    │ - Prometheus    │
                                │ - Backups       │    │ - Grafana       │
                                └─────────────────┘    └─────────────────┘